<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LA CASA DAS BET - Surebets</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark blue-gray background */
            color: #e2e8f0; /* Light gray text */
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem;
        }
        .header {
            background-color: #2d3748; /* Slightly lighter dark blue-gray */
            padding: 1.5rem;
            border-bottom-left-radius: 1rem;
            border-bottom-right-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .logo {
            font-size: 2.5rem;
            font-weight: 700;
            color: #4299e1; /* Blue for logo */
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .btn-primary {
            background-color: #4299e1; /* Blue */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .btn-primary:hover {
            background-color: #3182ce; /* Darker blue on hover */
        }
        .btn-secondary {
            background-color: #a0aec0; /* Gray */
            color: #2d3748;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .btn-secondary:hover {
            background-color: #718096; /* Darker gray on hover */
        }
        .card {
            background-color: #2d3748;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .input-field {
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #4a5568; /* Darker gray border */
            background-color: #1a202c;
            color: #e2e8f0;
            transition: border-color 0.3s ease;
        }
        .input-field:focus {
            outline: none;
            border-color: #4299e1; /* Blue border on focus */
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #2d3748;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 500px;
            position: relative;
        }
        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #e2e8f0;
            cursor: pointer;
        }
        .table-container {
            overflow-x: auto;
        }
        .surebet-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
        }
        .surebet-table th, .surebet-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #4a5568;
        }
        .surebet-table th {
            background-color: #4299e1;
            color: white;
            font-weight: 600;
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
        }
        .surebet-table tr:nth-child(even) {
            background-color: #2d3748;
        }
        .surebet-table tr:nth-child(odd) {
            background-color: #1a202c;
        }
        .surebet-table tr:hover {
            background-color: #4a5568;
        }
        .delete-btn {
            background-color: #e53e3e; /* Red */
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            transition: background-color 0.3s ease;
        }
        .delete-btn:hover {
            background-color: #c53030; /* Darker red on hover */
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">LA CASA DAS BET</div>
        <div class="flex gap-4">
            <button id="openCalculatorBtn" class="btn-primary">
                <i class="fas fa-calculator mr-2"></i> Calculadora de Surebets
            </button>
            <button id="openAdminPanelBtn" class="btn-secondary">
                <i class="fas fa-user-shield mr-2"></i> Painel Admin
            </button>
        </div>
    </div>

    <div class="container mt-8">
        <h2 class="text-3xl font-bold text-center mb-6 text-blue-400">Surebets Ativas</h2>
        <div id="surebetsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Surebets will be loaded here -->
            <div class="card p-6 flex flex-col items-center justify-center text-gray-400">
                <i class="fas fa-spinner fa-spin text-4xl mb-4"></i>
                <p>Carregando surebets...</p>
            </div>
        </div>
    </div>

    <!-- Surebet Calculator Modal -->
    <div id="calculatorModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeCalculatorBtn">&times;</button>
            <h3 class="text-2xl font-bold mb-4 text-blue-400">Calculadora de Surebets</h3>
            <div class="mb-4">
                <label for="odd1" class="block text-sm font-medium mb-1">Odd 1:</label>
                <input type="number" id="odd1" class="input-field" placeholder="Ex: 2.02" step="0.01">
            </div>
            <div class="mb-4">
                <label for="odd2" class="block text-sm font-medium mb-1">Odd 2:</label>
                <input type="number" id="odd2" class="input-field" placeholder="Ex: 2.02" step="0.01">
            </div>
            <div class="mb-4">
                <label for="odd3" class="block text-sm font-medium mb-1">Odd 3 (Opcional):</label>
                <input type="number" id="odd3" class="input-field" placeholder="Ex: 3.50" step="0.01">
            </div>
            <div class="mb-4">
                <label for="totalStake" class="block text-sm font-medium mb-1">Valor Total a Apostar (R$):</label>
                <input type="number" id="totalStake" class="input-field" placeholder="Ex: 100" step="0.01">
            </div>
            <button id="calculateBtn" class="btn-primary w-full mb-4">Calcular</button>
            <div id="calculatorResults" class="mt-4 p-4 bg-gray-700 rounded-md">
                <p class="text-lg font-semibold text-blue-300">Resultados:</p>
                <p id="totalProbability" class="mt-2"></p>
                <p id="stake1"></p>
                <p id="stake2"></p>
                <p id="stake3"></p>
                <p id="profit"></p>
            </div>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="adminPanelModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeAdminPanelBtn">&times;</button>
            <h3 class="text-2xl font-bold mb-4 text-blue-400">Painel de Controle</h3>

            <!-- Admin Login Form -->
            <div id="adminLoginForm">
                <p class="mb-4">Para acessar o painel, por favor, insira a senha.</p>
                <div class="mb-4">
                    <label for="adminPassword" class="block text-sm font-medium mb-1">Senha:</label>
                    <input type="password" id="adminPassword" class="input-field" placeholder="Sua senha">
                </div>
                <button id="loginAdminBtn" class="btn-primary w-full">Entrar</button>
                <p id="loginError" class="text-red-500 text-sm mt-2 hidden">Senha incorreta!</p>
            </div>

            <!-- Admin Content (hidden by default) -->
            <div id="adminContent" class="hidden">
                <h4 class="text-xl font-bold mb-4 text-blue-300">Adicionar Nova Surebet</h4>
                <form id="addSurebetForm" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label for="match" class="block text-sm font-medium mb-1">Partida:</label>
                        <input type="text" id="match" class="input-field" placeholder="Ex: Vasco X Santos" required>
                    </div>
                    <div>
                        <label for="time" class="block text-sm font-medium mb-1">Hor√°rio:</label>
                        <input type="text" id="time" class="input-field" placeholder="Ex: 15:00" required>
                    </div>
                    <div>
                        <label for="date" class="block text-sm font-medium mb-1">Data:</label>
                        <input type="date" id="date" class="input-field" required>
                    </div>
                    <div>
                        <label for="sport" class="block text-sm font-medium mb-1">Esporte:</label>
                        <select id="sport" class="input-field" required>
                            <option value="">Selecione o Esporte</option>
                            <option value="Futebol">Futebol</option>
                            <option value="Basquete">Basquete</option>
                            <option value="Tenis">T√™nis</option>
                            <option value="Outros">Outros</option>
                        </select>
                    </div>
                    <div class="md:col-span-2">
                        <label for="marketHomeOdd" class="block text-sm font-medium mb-1">Mercado, Casa e Odd (Ex: Bet365 - Mais de 19,5 chutes Vasco - Odd 2.02):</label>
                        <textarea id="marketHomeOdd" class="input-field h-24" placeholder="Detalhes da aposta" required></textarea>
                    </div>
                    <div>
                        <label for="profitPercentage" class="block text-sm font-medium mb-1">Lucro (%):</label>
                        <input type="number" id="profitPercentage" class="input-field" placeholder="Ex: 2.0" step="0.01" required>
                    </div>
                    <div class="md:col-span-2 flex justify-end">
                        <button type="submit" class="btn-primary">Adicionar Surebet</button>
                    </div>
                </form>

                <h4 class="text-xl font-bold mb-4 text-blue-300">Surebets Cadastradas</h4>
                <div class="table-container">
                    <table id="adminSurebetsTable" class="surebet-table">
                        <thead>
                            <tr>
                                <th>Partida</th>
                                <th>Hor√°rio</th>
                                <th>Data</th>
                                <th>Esporte</th>
                                <th>Mercado/Casa/Odd</th>
                                <th>Lucro (%)</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Admin surebets will be loaded here -->
                            <tr>
                                <td colspan="7" class="text-center text-gray-400 py-4">Carregando surebets...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Alert Modal -->
    <div id="customAlertModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeAlertBtn">&times;</button>
            <h3 id="alertTitle" class="text-xl font-bold mb-4 text-blue-400"></h3>
            <p id="alertMessage" class="mb-4"></p>
            <button id="confirmAlertBtn" class="btn-primary w-full">OK</button>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script type="module">
        // Firebase imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Firebase configuration from the user
        const firebaseConfig = {
            apiKey: "AIzaSyArY5MJpAlRnQhWV3TYrsh9LYH9Sw2nAeo",
            authDomain: "surebet-4916a.firebaseapp.com",
            projectId: "surebet-4916a",
            storageBucket: "surebet-4916a.firebasestorage.app",
            messagingSenderId: "975170682118",
            appId: "1:975170682118:web:1a551a221f1436bd8f3287",
            measurementId: "G-VQR0H34N9Q"
        };

        // Initialize Firebase
        // Global variables for Canvas environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfigFromCanvas = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : firebaseConfig;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // Use the firebaseConfig from Canvas if available, otherwise fallback to the hardcoded one
        const app = initializeApp(firebaseConfigFromCanvas);
        const db = getFirestore(app);
        const auth = getAuth(app);

        let userId = null; // Will be set after authentication

        // --- Authentication Setup ---
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                console.log("User authenticated:", userId);
                // Listen for surebets only after authentication
                listenForSurebets();
            } else {
                // Sign in anonymously if no token is provided or user is not authenticated
                try {
                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                } catch (error) {
                    console.error("Error during anonymous sign-in or custom token sign-in:", error);
                    showCustomAlert("Erro de Autentica√ß√£o", "N√£o foi poss√≠vel autenticar. Tente novamente mais tarde.");
                }
            }
        });

        // --- UI Elements ---
        const openCalculatorBtn = document.getElementById('openCalculatorBtn');
        const calculatorModal = document.getElementById('calculatorModal');
        const closeCalculatorBtn = document.getElementById('closeCalculatorBtn');
        const calculateBtn = document.getElementById('calculateBtn');
        const odd1Input = document.getElementById('odd1');
        const odd2Input = document.getElementById('odd2');
        const odd3Input = document.getElementById('odd3');
        const totalStakeInput = document.getElementById('totalStake');
        const totalProbabilitySpan = document.getElementById('totalProbability');
        const stake1Span = document.getElementById('stake1');
        const stake2Span = document.getElementById('stake2');
        const stake3Span = document.getElementById('stake3');
        const profitSpan = document.getElementById('profit');

        const openAdminPanelBtn = document.getElementById('openAdminPanelBtn');
        const adminPanelModal = document.getElementById('adminPanelModal');
        const closeAdminPanelBtn = document.getElementById('closeAdminPanelBtn');
        const adminLoginForm = document.getElementById('adminLoginForm');
        const adminPasswordInput = document.getElementById('adminPassword');
        const loginAdminBtn = document.getElementById('loginAdminBtn');
        const loginError = document.getElementById('loginError');
        const adminContent = document.getElementById('adminContent');

        const addSurebetForm = document.getElementById('addSurebetForm');
        const matchInput = document.getElementById('match');
        const timeInput = document.getElementById('time');
        const dateInput = document.getElementById('date');
        const sportSelect = document.getElementById('sport');
        const marketHomeOddInput = document.getElementById('marketHomeOdd');
        const profitPercentageInput = document.getElementById('profitPercentage');

        const surebetsList = document.getElementById('surebetsList');
        const adminSurebetsTableBody = document.querySelector('#adminSurebetsTable tbody');

        const customAlertModal = document.getElementById('customAlertModal');
        const alertTitle = document.getElementById('alertTitle');
        const alertMessage = document.getElementById('alertMessage');
        const closeAlertBtn = document.getElementById('closeAlertBtn');
        const confirmAlertBtn = document.getElementById('confirmAlertBtn');

        const ADMIN_PASSWORD = '37511158'; // Senha do painel de controle

        // --- Modal Functions ---
        function showModal(modalElement) {
            modalElement.classList.add('show');
        }

        function hideModal(modalElement) {
            modalElement.classList.remove('show');
        }

        function showCustomAlert(title, message) {
            alertTitle.textContent = title;
            alertMessage.textContent = message;
            showModal(customAlertModal);
        }

        // --- Event Listeners ---
        openCalculatorBtn.addEventListener('click', () => showModal(calculatorModal));
        closeCalculatorBtn.addEventListener('click', () => hideModal(calculatorModal));

        openAdminPanelBtn.addEventListener('click', () => {
            // Reset admin panel state on open
            adminLoginForm.classList.remove('hidden');
            adminContent.classList.add('hidden');
            loginError.classList.add('hidden');
            adminPasswordInput.value = '';
            showModal(adminPanelModal);
        });
        closeAdminPanelBtn.addEventListener('click', () => hideModal(adminPanelModal));

        closeAlertBtn.addEventListener('click', () => hideModal(customAlertModal));
        confirmAlertBtn.addEventListener('click', () => hideModal(customAlertModal));

        // --- Surebet Calculator Logic ---
        calculateBtn.addEventListener('click', () => {
            const odd1 = parseFloat(odd1Input.value);
            const odd2 = parseFloat(odd2Input.value);
            const odd3 = parseFloat(odd3Input.value); // Optional
            const totalStake = parseFloat(totalStakeInput.value);

            if (isNaN(odd1) || isNaN(odd2) || isNaN(totalStake) || odd1 <= 1 || odd2 <= 1 || totalStake <= 0) {
                showCustomAlert("Erro de C√°lculo", "Por favor, insira odds v√°lidas (maiores que 1) e um valor total a apostar v√°lido.");
                return;
            }

            let impliedProbability1 = 1 / odd1;
            let impliedProbability2 = 1 / odd2;
            let impliedProbability3 = odd3 > 1 ? (1 / odd3) : 0;

            let totalImpliedProbability = impliedProbability1 + impliedProbability2 + impliedProbability3;

            if (totalImpliedProbability >= 1) {
                showCustomAlert("N√£o √© Surebet", "A soma das probabilidades impl√≠citas √© maior ou igual a 1. Isso n√£o √© uma surebet.");
                totalProbabilitySpan.textContent = `Probabilidade Total: ${ (totalImpliedProbability * 100).toFixed(2) }% (N√£o √© Surebet)`;
                stake1Span.textContent = '';
                stake2Span.textContent = '';
                stake3Span.textContent = '';
                profitSpan.textContent = '';
                return;
            }

            const surebetPercentage = (1 - totalImpliedProbability) * 100;

            const stake1 = (impliedProbability1 / totalImpliedProbability) * totalStake;
            const stake2 = (impliedProbability2 / totalImpliedProbability) * totalStake;
            const stake3 = odd3 > 1 ? (impliedProbability3 / totalImpliedProbability) * totalStake : 0;

            const return1 = stake1 * odd1;
            const return2 = stake2 * odd2;
            const return3 = odd3 > 1 ? stake3 * odd3 : 0;

            const guaranteedReturn = Math.min(return1, return2, odd3 > 1 ? return3 : Infinity);
            const profitValue = guaranteedReturn - totalStake;

            totalProbabilitySpan.textContent = `Probabilidade Total: ${ (totalImpliedProbability * 100).toFixed(2) }% (Surebet de ${surebetPercentage.toFixed(2)}%)`;
            stake1Span.textContent = `Aposta 1: R$ ${stake1.toFixed(2)}`;
            stake2Span.textContent = `Aposta 2: R$ ${stake2.toFixed(2)}`;
            stake3Span.textContent = odd3 > 1 ? `Aposta 3: R$ ${stake3.toFixed(2)}` : '';
            profitSpan.textContent = `Lucro Garantido: R$ ${profitValue.toFixed(2)}`;
        });

        // --- Admin Panel Login Logic ---
        loginAdminBtn.addEventListener('click', () => {
            const enteredPassword = adminPasswordInput.value;
            if (enteredPassword === ADMIN_PASSWORD) {
                adminLoginForm.classList.add('hidden');
                adminContent.classList.remove('hidden');
                loginError.classList.add('hidden');
                showCustomAlert("Sucesso!", "Acesso ao painel de controle concedido.");
            } else {
                loginError.classList.remove('hidden');
                showCustomAlert("Erro de Acesso", "Senha incorreta. Tente novamente.");
            }
        });

        // --- Add Surebet Logic ---
        addSurebetForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!userId) {
                showCustomAlert("Erro", "Usu√°rio n√£o autenticado. Tente novamente.");
                return;
            }

            const newSurebet = {
                match: matchInput.value,
                time: timeInput.value,
                date: dateInput.value,
                sport: sportSelect.value,
                marketHomeOdd: marketHomeOddInput.value,
                profitPercentage: parseFloat(profitPercentageInput.value),
                timestamp: new Date() // Add a timestamp for ordering
            };

            try {
                // Store surebets in a public collection for all users to see
                const surebetsCollectionRef = collection(db, `artifacts/${appId}/public/data/surebets`);
                await addDoc(surebetsCollectionRef, newSurebet);
                showCustomAlert("Sucesso!", "Surebet adicionada com sucesso!");
                addSurebetForm.reset(); // Clear the form
            } catch (error) {
                console.error("Erro ao adicionar surebet:", error);
                showCustomAlert("Erro", "N√£o foi poss√≠vel adicionar a surebet. Tente novamente.");
            }
        });

        // --- Listen for Surebets (Real-time updates) ---
        function listenForSurebets() {
            if (!userId) {
                console.log("Waiting for user authentication to listen for surebets.");
                return;
            }

            // Query for surebets, ordered by timestamp for consistent display
            const surebetsQuery = query(collection(db, `artifacts/${appId}/public/data/surebets`), orderBy("timestamp", "desc"));

            onSnapshot(surebetsQuery, (snapshot) => {
                const surebets = [];
                snapshot.forEach((doc) => {
                    surebets.push({ id: doc.id, ...doc.data() });
                });
                displaySurebets(surebets);
                displayAdminSurebets(surebets);
            }, (error) => {
                console.error("Erro ao buscar surebets:", error);
                showCustomAlert("Erro de Carregamento", "N√£o foi poss√≠vel carregar as surebets.");
            });
        }

        // --- Display Surebets on Main Page ---
        function displaySurebets(surebets) {
            surebetsList.innerHTML = ''; // Clear previous surebets
            if (surebets.length === 0) {
                surebetsList.innerHTML = `
                    <div class="card p-6 col-span-full text-center text-gray-400">
                        <p>Nenhuma surebet ativa no momento.</p>
                    </div>
                `;
                return;
            }

            surebets.forEach(surebet => {
                const surebetCard = `
                    <div class="card p-6 border-l-4 border-blue-500 hover:shadow-lg transition-shadow duration-300">
                        <h3 class="text-xl font-bold text-blue-400 mb-2">${surebet.match}</h3>
                        <p class="text-sm text-gray-400 mb-1"><i class="far fa-clock mr-2"></i> ${surebet.time} em ${new Date(surebet.date).toLocaleDateString('pt-BR')}</p>
                        <p class="text-sm text-gray-400 mb-2"><i class="fas fa-futbol mr-2"></i> ${surebet.sport}</p>
                        <p class="text-md mb-2">${surebet.marketHomeOdd}</p>
                        <div class="text-right">
                            <span class="inline-block bg-green-600 text-white text-sm font-semibold px-3 py-1 rounded-full">
                                Lucro: ${surebet.profitPercentage.toFixed(2)}%
                            </span>
                        </div>
                    </div>
                `;
                surebetsList.innerHTML += surebetCard;
            });
        }

        // --- Display Surebets in Admin Panel ---
        function displayAdminSurebets(surebets) {
            adminSurebetsTableBody.innerHTML = ''; // Clear previous entries
            if (surebets.length === 0) {
                adminSurebetsTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center text-gray-400 py-4">Nenhuma surebet cadastrada.</td>
                    </tr>
                `;
                return;
            }

            surebets.forEach(surebet => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${surebet.match}</td>
                    <td>${surebet.time}</td>
                    <td>${new Date(surebet.date).toLocaleDateString('pt-BR')}</td>
                    <td>${surebet.sport}</td>
                    <td>${surebet.marketHomeOdd}</td>
                    <td>${surebet.profitPercentage.toFixed(2)}%</td>
                    <td>
                        <button class="delete-btn" data-id="${surebet.id}">
                            <i class="fas fa-trash-alt"></i> Excluir
                        </button>
                    </td>
                `;
                adminSurebetsTableBody.appendChild(row);
            });
        }

        // --- Delete Surebet Logic ---
        adminSurebetsTableBody.addEventListener('click', async (e) => {
            if (e.target.classList.contains('delete-btn')) {
                const surebetId = e.target.dataset.id;
                if (!surebetId) {
                    showCustomAlert("Erro", "ID da surebet n√£o encontrado para exclus√£o.");
                    return;
                }

                if (!userId) {
                    showCustomAlert("Erro", "Usu√°rio n√£o autenticado. N√£o √© poss√≠vel excluir.");
                    return;
                }

                // Show a confirmation dialog using the custom alert modal
                showCustomAlert("Confirmar Exclus√£o", "Tem certeza que deseja excluir esta surebet?");
                document.getElementById('confirmAlertBtn').onclick = async () => {
                    hideModal(customAlertModal); // Hide the confirmation
                    try {
                        // Ensure the path matches the collection path used for adding
                        const surebetDocRef = doc(db, `artifacts/${appId}/public/data/surebets`, surebetId);
                        await deleteDoc(surebetDocRef);
                        showCustomAlert("Sucesso!", "Surebet exclu√≠da com sucesso!");
                    } catch (error) {
                        console.error("Erro ao excluir surebet:", error);
                        showCustomAlert("Erro", "N√£o foi poss√≠vel excluir a surebet. Tente novamente.");
                    }
                    // Reset the confirm button's onclick to its default behavior
                    document.getElementById('confirmAlertBtn').onclick = () => hideModal(customAlertModal);
                };
            }
        });

        // Initial call to listen for surebets (will only run after auth is ready)
        // No need to call it here, as it's called inside onAuthStateChanged.
    </script>
</body>
</html>
